---
title: Auth0 Integration
description: Learn how to integrate Tambo with Auth0 for user authentication.
---

This guide shows how to integrate Tambo with Auth0 in a Next.js application.

<Callout type="info" title="Prerequisites">
  This assumes you have already installed and configured Auth0 in your Next.js
  application. If you haven't, follow the [Auth0 Next.js Quick Start
  guide](https://auth0.com/docs/quickstart/webapp/nextjs) to set up Auth0
  authentication first.
</Callout>

<Callout type="info" title="Required API Routes">
  These docs assume you have already set up the Auth0 API routes at
  `/api/auth/[...auth0]/route.ts`.
</Callout>

## Required Packages

```bash
npm install @auth0/nextjs-auth0
npm install @tambo-ai/react
```

## Server-Side Token Retrieval

Create a server component to retrieve the user's access token:

```tsx title="app/layout.tsx"
import { getAccessToken } from "@auth0/nextjs-auth0";
import ClientLayout from "./client-layout";

export default async function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  let accessToken: string | undefined;

  try {
    // Get the access token from Auth0
    const tokenResponse = await getAccessToken();
    accessToken = tokenResponse.accessToken;
  } catch (error) {
    // User is not authenticated
    console.log("User not authenticated");
  }

  return (
    <html lang="en">
      <body>
        <ClientLayout userToken={accessToken}>{children}</ClientLayout>
      </body>
    </html>
  );
}
```

## Client-Side Integration

Create a client component to wrap your app with both Auth0's UserProvider and TamboProvider:

```tsx title="app/client-layout.tsx"
"use client";

import { UserProvider } from "@auth0/nextjs-auth0/client";
import { TamboProvider } from "@tambo-ai/react";
import { ReactNode } from "react";

interface ClientLayoutProps {
  children: ReactNode;
  userToken?: string;
}

export default function ClientLayout({
  children,
  userToken,
}: ClientLayoutProps) {
  // UserProvider needed for Auth0 client-side hooks
  // TamboProvider must be in a client component to handle token state
  return (
    <UserProvider>
      <TamboProvider userToken={userToken}>{children}</TamboProvider>
    </UserProvider>
  );
}
```

## Alternative: Client-Side Token Retrieval

If you prefer to handle token retrieval on the client side, you can use Auth0's `useUser` hook:

```tsx title="app/client-layout-alternative.tsx"
"use client";

import { useUser } from "@auth0/nextjs-auth0/client";
import { TamboProvider } from "@tambo-ai/react";
import { ReactNode, useEffect, useState } from "react";

interface ClientLayoutProps {
  children: ReactNode;
}

export default function ClientLayout({ children }: ClientLayoutProps) {
  const { user, isLoading } = useUser();
  const [accessToken, setAccessToken] = useState<string | undefined>();

  useEffect(() => {
    if (user && !isLoading) {
      // Fetch access token from Auth0
      const fetchToken = async () => {
        try {
          const response = await fetch("/api/auth/token");
          const data = await response.json();
          setAccessToken(data.accessToken);
        } catch (error) {
          console.error("Error fetching token:", error);
        }
      };

      fetchToken();
    }
  }, [user, isLoading]);

  // TamboProvider must be in a client component to handle token state
  return <TamboProvider userToken={accessToken}>{children}</TamboProvider>;
}
```

For the client-side approach, create a token endpoint:

```tsx title="app/api/auth/token/route.ts"
import { getAccessToken } from "@auth0/nextjs-auth0";
import { NextResponse } from "next/server";

export async function GET() {
  try {
    const { accessToken } = await getAccessToken();
    return NextResponse.json({ accessToken });
  } catch (error) {
    return NextResponse.json({ error: "Unauthorized" }, { status: 401 });
  }
}
```

## Usage in Components

Now you can use Tambo components in your authenticated pages:

```tsx title="app/dashboard/page.tsx"
import { MessageThreadFull } from "@components/ui/tambo";

export default function Dashboard() {
  return (
    <div>
      <h1>Dashboard</h1>
      <MessageThreadFull />
    </div>
  );
}
```

<Callout type="info" title="Token Scope">
  Make sure your Auth0 application is configured with the appropriate scopes to
  access the resources your Tambo application needs. The access token will be
  automatically passed to Tambo for user identification.
</Callout>
